/*! For license information please see tareas.bundle.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t,n,r,a;function o(){"use strict";o=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,o=Object.create(a.prototype),i=new M(r||[]);return c(o,"_invoke",{value:O(e,n,i)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function E(){}function w(){}var T={};d(T,s,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&a.call(k,s)&&(T=k);var I=w.prototype=b.prototype=Object.create(T);function B(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function L(t,n){function r(o,c,i,s){var l=f(t[o],t,c);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):n.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(l.arg)}var o;c(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,a){r(e,t,n,a)}))}return o=o?o.then(a,a):a()}})}function O(e,n,r){var a=h;return function(o,c){if(a===v)throw Error("Generator is already running");if(a===y){if("throw"===o)throw c;return{value:t,done:!0}}for(r.method=o,r.arg=c;;){var i=r.delegate;if(i){var s=j(i,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=f(e,n,r);if("normal"===l.type){if(a=r.done?y:m,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=y,r.method="throw",r.arg=l.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var c=o.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,c=function e(){for(;++o<n.length;)if(a.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return E.prototype=w,c(I,"constructor",{value:w,configurable:!0}),c(w,"constructor",{value:E,configurable:!0}),E.displayName=d(w,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,d(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},B(L.prototype),d(L.prototype,l,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,r,a,o){void 0===o&&(o=Promise);var c=new L(p(e,t,r,a),o);return n.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},B(I),d(I,u,"Generator"),d(I,s,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=N,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return i.type="throw",i.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var c=this.tryEntries[o],i=c.completion;if("root"===c.tryLoc)return r("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),l=a.call(c,"finallyLoc");if(s&&l){if(this.prev<c.catchLoc)return r(c.catchLoc,!0);if(this.prev<c.finallyLoc)return r(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return r(c.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return r(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},n}function c(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}var s=new URLSearchParams(window.location.search).get("tablero");console.log("Tablero ID desde la URL: ".concat(s));var l='\n{\n  panel (id:"'.concat(s,'"){\n    id,\n    titulo,\n    descripcion,\n    tasks {\n      id,\n      titulo,\n      descripcion,\n      fecha,\n      hora,\n      responsable,\n      estado\n    }\n  }\n}\n');function u(){return u=i(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l,variables:{id:t}})});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,n.ok?(a=r.data,console.log("Tablero cargado:",a),a?(tareas=a.tasks||[],v()):(console.error("Tablero no encontrado: ".concat(t)),alert("El tablero no existe."),d())):console.error("Error al cargar el tablero:",r.errors),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error al cargar el tablero:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),u.apply(this,arguments)}function d(){window.location.href="/index.html"}function p(e,t){var n=document.createElement("div");n.classList.add("tarea"),n.setAttribute("id",e.id),n.setAttribute("draggable","true"),n.setAttribute("ondragstart","drag(event)"),n.setAttribute("ondragend","endDrag(event)"),n.innerHTML="\n    <p><strong>Título:</strong> ".concat(e.titulo,"</p>\n    <p><strong>Descripción:</strong> ").concat(e.descripcion,"</p>\n    <p><strong>Fecha:</strong> ").concat(e.fecha,"</p>\n    <p><strong>Hora:</strong> ").concat(e.hora,"</p>\n    <p><strong>Responsable:</strong> ").concat(e.responsable,'</p>\n    <button class="btn btn-danger btn-sm">Eliminar</button>\n    <button class="btn btn-warning btn-sm">Modificar</button>\n  '),n.getElementsByClassName("btn-danger")[0].addEventListener("click",(function(){var t;t=e.id,tareaParaEliminar=t,new bootstrap.Modal(document.getElementById("modalConfirmarEliminar")).show()})),n.getElementsByClassName("btn-warning")[0].addEventListener("click",(function(){!function(e){f.apply(this,arguments)}(e.id)})),t.appendChild(n)}function f(){return(f=i(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return tareaParaModificar=t,n='\n      query {\n        task(id: "'.concat(t,'") {\n          id\n          titulo\n          descripcion\n          fecha\n          hora\n          responsable\n          estado\n        }\n      }\n    '),e.prev=2,e.next=5,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});case 5:return r=e.sent,e.next=8,r.json();case 8:a=e.sent,r.ok?tarea=a.data.task:console.error("Error al obtener la tarea:",a.errors),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("Error en la solicitud:",e.t0);case 15:tarea&&(document.getElementById("tituloModificarTarea").value=tarea.titulo,document.getElementById("descripcionModificarTarea").value=tarea.descripcion,document.getElementById("fechaModificarTarea").value=new Date(parseInt(tarea.fecha)).toISOString().split("T")[0],document.getElementById("horaModificarTarea").value=tarea.hora,document.getElementById("responsableModificarTarea").value=tarea.responsable,new bootstrap.Modal(document.getElementById("modalModificarTarea")).show());case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}null===(t=document.getElementById("volverAlDashboardButton"))||void 0===t||t.addEventListener("click",d),function(e){u.apply(this,arguments)}(s),null===(n=document.getElementById("formNuevaTarea"))||void 0===n||n.addEventListener("submit",function(){var e=i(o().mark((function e(t){var n,r,a,c,i,l,u,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.getElementById("tituloTarea").value,r=document.getElementById("descripcionTarea").value,a=document.getElementById("fechaTarea").value,c=document.getElementById("horaTarea").value,i=document.getElementById("responsableTarea").value,l={id:"tarea-".concat(Date.now()),titulo:n,descripcion:r,fecha:a,hora:c,responsable:i,estado:"to-do",panelId:s},u='\n    mutation {\n      addTask(\n        titulo: "'.concat(l.titulo,'",\n        descripcion: "').concat(l.descripcion,'",\n        fecha: "').concat(l.fecha,'",\n        hora: "').concat(l.hora,'",\n        responsable: "').concat(l.responsable,'",\n        estado: "').concat(l.estado,'",\n        panelId: "').concat(l.panelId,'"\n      ) {\n        id\n        titulo\n        descripcion\n        fecha\n        hora\n        responsable\n        estado\n        panelId\n      }\n    }\n  '),e.prev=8,e.next=11,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:u})});case 11:return d=e.sent,e.next=14,d.json();case 14:f=e.sent,d.ok?(console.log("Tarea creada con éxito:",f.data.createTask),l.id=f.data.addTask.id):console.error("Error al crear la tarea:",f.errors),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),console.error("Error en la solicitud:",e.t0);case 21:tareas.push(l),p(l,document.getElementById("to-do-column")),document.getElementById("formNuevaTarea").reset(),bootstrap.Modal.getInstance(document.getElementById("modalNuevaTarea")).hide();case 26:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}()),null===(r=document.getElementById("botonConfirmarEliminar"))||void 0===r||r.addEventListener("click",i(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===tareaParaEliminar){e.next=17;break}return bootstrap.Modal.getInstance(document.getElementById("modalConfirmarEliminar")).hide(),t='\n        mutation {\n          deleteTask(id: "'.concat(tareaParaEliminar,'") {\n            id\n          }\n        }\n      '),e.prev=4,e.next=7,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});case 7:return n=e.sent,e.next=10,n.json();case 10:r=e.sent,n.ok?(console.log("Tarea eliminada con éxito:",r.data.deleteTask),v()):console.error("Error al eliminar la tarea:",r.errors),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.error("Error en la solicitud:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})))),null===(a=document.getElementById("formModificarTarea"))||void 0===a||a.addEventListener("submit",function(){var e=i(o().mark((function e(t){var n,r,a,c,i,s,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.getElementById("tituloModificarTarea").value,r=document.getElementById("descripcionModificarTarea").value,a=document.getElementById("fechaModificarTarea").value,c=document.getElementById("horaModificarTarea").value,i=document.getElementById("responsableModificarTarea").value,s='\n        mutation {\n          updateTask(\n            id: "'.concat(tareaParaModificar,'",\n            titulo: "').concat(n,'",\n            descripcion: "').concat(r,'",\n            fecha: "').concat(a,'",\n            hora: "').concat(c,'",\n            responsable: "').concat(i,'"\n          ) {\n            id\n            titulo\n            descripcion\n            fecha\n            hora\n            responsable\n            estado\n          }\n        }\n      '),e.prev=7,e.next=10,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s})});case 10:return l=e.sent,e.next=13,l.json();case 13:u=e.sent,l.ok?(console.log("Tarea actualizada con éxito:",u.data.updateTask),v()):console.error("Error al actualizar la tarea:",u.errors),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),console.error("Error en la solicitud:",e.t0);case 20:bootstrap.Modal.getInstance(document.getElementById("modalModificarTarea")).hide();case 22:case"end":return e.stop()}}),e,null,[[7,17]])})));return function(t){return e.apply(this,arguments)}}());var h=document.getElementById("formNuevaTarea");function m(e){var t=document.getElementById("".concat(e,"-column"));if(t)for(var n=t.getElementsByClassName("tarea");n.length>0;)n[0].remove()}function v(){return y.apply(this,arguments)}function y(){return(y=i(o().mark((function e(){var t,n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,t.ok?(r=n.data.panel,a=r.tasks,console.log("Tareas cargadas:",a),m("doing"),m("done"),m("to-do"),a.forEach((function(e){var t=document.getElementById("".concat(e.estado,"-column"));t&&p(e,t)}))):console.error("Error al cargar tareas:",n.errors),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error al cargar tareas:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}h&&h.addEventListener("submit",function(){var e=i(o().mark((function e(t){var n,r,a,c,i,s,l,u,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=document.getElementById("tituloTarea").value.trim(),r=document.getElementById("descripcionTarea").value.trim(),a=document.getElementById("fechaTarea").value.trim(),c=document.getElementById("horaTarea").value.trim(),i=document.getElementById("responsableTarea").value.trim(),s=document.getElementById("fileTarea").files[0],n&&r&&a&&c&&i){e.next=10;break}return alert("Por favor, completa todos los campos."),e.abrupt("return");case 10:return(l=new FormData).append("titulo",n),l.append("descripcion",r),l.append("fecha",a),l.append("hora",c),l.append("responsable",i),l.append("file",s),e.prev=17,e.next=20,fetch("/api/tasks",{method:"POST",body:l});case 20:return u=e.sent,e.next=23,u.json();case 23:d=e.sent,u.ok?(console.log("Tarea creada con éxito:",d),h.reset(),v()):console.error("Error al crear la tarea:",d.error),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(17),console.error("Error en la solicitud:",e.t0);case 30:case"end":return e.stop()}}),e,null,[[17,27]])})));return function(t){return e.apply(this,arguments)}}());var g=io("");g.on("newTask",(function(e){p(e,document.getElementById("to-do-column"))})),g.on("updateTask",(function(e){var t=document.getElementById(e.id);t&&(t.innerHTML="\n      <p><strong>Título:</strong> ".concat(e.titulo,"</p>\n      <p><strong>Descripción:</strong> ").concat(e.descripcion,"</p>\n      <p><strong>Fecha:</strong> ").concat(e.fecha,"</p>\n      <p><strong>Hora:</strong> ").concat(e.hora,"</p>\n      <p><strong>Responsable:</strong> ").concat(e.responsable,"</p>\n      ").concat(e.filePath?'<p><a href="'.concat(e.filePath,'" target="_blank">Archivo Adjunto</a></p>'):"","\n    "))})),g.on("deleteTask",(function(e){var t;null===(t=document.getElementById(e))||void 0===t||t.remove()}))})();